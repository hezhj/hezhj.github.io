<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Mathematical Statistics</title>
    <meta charset="utf-8" />
    <meta name="author" content="Zhijian He" />
    <meta name="date" content="2021-03-02" />
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <link href="libs/remark-css/default-fonts.css" rel="stylesheet" />
    <script src="libs/htmlwidgets/htmlwidgets.js"></script>
    <script src="libs/d3/d3.min.js"></script>
    <script src="libs/dagre/dagre-d3.min.js"></script>
    <link href="libs/mermaid/dist/mermaid.css" rel="stylesheet" />
    <script src="libs/mermaid/dist/mermaid.slim.min.js"></script>
    <link href="libs/DiagrammeR-styles/styles.css" rel="stylesheet" />
    <script src="libs/chromatography/chromatography.js"></script>
    <script src="libs/DiagrammeR-binding/DiagrammeR.js"></script>
    <script src="libs/jquery/jquery.min.js"></script>
    <link href="libs/datatables-css/datatables-crosstalk.css" rel="stylesheet" />
    <script src="libs/datatables-binding/datatables.js"></script>
    <link href="libs/dt-core/css/jquery.dataTables.min.css" rel="stylesheet" />
    <link href="libs/dt-core/css/jquery.dataTables.extra.css" rel="stylesheet" />
    <script src="libs/dt-core/js/jquery.dataTables.min.js"></script>
    <link href="libs/crosstalk/css/crosstalk.css" rel="stylesheet" />
    <script src="libs/crosstalk/js/crosstalk.min.js"></script>
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Mathematical Statistics
## Lecture 1
### Zhijian He
### School of Mathematics, SCUT
### 2021-03-02

---





# Outline

## 1. Overview 

## 2. Review of Probability

## 3. Fundamentals of Statistics

---
class: inverse, middle, center

# Part I: Overview

---

## Introduction


- Statistics is for "learning about the world from data".

- To solve real problems in biology, engineering, education, economics, commerce etc.

- The data we saw are a `sample`, not the whole `population` we care about. 

### Toy examples

- A coin is thrown five times, and the sequence of heads and tails is observed: {H T H T T}

- Measurement data

### Survey sampling

- Governments survey human populations

- Quality control: the output of a manufacturing process may be sampled in order to examine the items for defects.


---

## The actual composition of the sample is random


<div id="htmlwidget-c5a2eca91cd8fc5d0064" style="width:504px;height:400px;" class="DiagrammeR html-widget"></div>
<script type="application/json" data-for="htmlwidget-c5a2eca91cd8fc5d0064">{"x":{"diagram":"\ngraph LR\nA[Data generating mechanism] --> B(Sample #1) \nB --> BB(obs. #1)\nA --> C(Sample #2)\nC --> CC(obs. #2)\nA --> D(Sample #i)\nD --> DD(obs. #i)\nA --> E(Sample #n)\nE --> EE(obs. #n)\n"},"evals":[],"jsHooks":[]}</script>

- Data generating mechanism: Population `\(P\)`

- Samples: `\(X_1,\dots, X_n\)` (random variables, r.v.s); sample size: `\(n\)`

- observations: `\(x_1,\dots, x_n\)` (numerics)


---
## Data analysis: Two levels

Statistical methods are often grouped into two broad categories--descriptive statistics
and inferential statistics.

### Level 1: descriptive/exploratory statistical analysis

- displaying the data: figures, tables, etc.

- summarizing the data: mean, median, etc.

### Level 2: statistical inference


- The population `\(P\)` is at least partly unknown.

- Statistical models are employed.

- Statistical inference is concerned with methods of using
observations (data) to obtain information concerning the distribution of the population based on **a working model**.


---
## A big picture of statistical analysis


![](figs/bigpic.gif)

.center[
Source: [https://courses.lumenlearning.com](https://courses.lumenlearning.com/wmopen-concepts-statistics/chapter/why-it-matters-why-it-matters-types-of-statistical-studies-and-producing-data/)
]

- real model vs. working model

- **George Box**: All models are wrong, but some are useful.

---

## Case study: earthquakes data

The data are routinely recorded
by a seismograph (地震仪)—listed chronologically are the occurrence times and Richter
magnitudes (里氏震级) for a series of earthquakes.

![](figs/earthquakes.png)

- As raw data, the numbers are **largely meaningless**.

- No patterns are evident, nor is there any obvious connection
between the frequencies of tremors and their severities.

---
## Case study: earthquakes data

&lt;img src="figs/magnitude.jpg" width="80%" style="display: block; margin: auto;" /&gt;



- The figure is the result of applying **several descriptive techniques** to an actual set of seismograph data recorded over a period of
several years in southern California. 

- `\(N\)` is counted for the period `\([R- 0.25, R+0.25]\)`.

---
## Case study: earthquakes data

Earthquake frequencies `\(N\)` and severities `\(R\)` are clearly related:

`$$N = 80338.16 e^{-1.981 R}$$`

Setting `\(R=10\)`, one gets

`$$N = 80338.16 e^{-1.981 \times 10}=0.0002\quad \text{ earthquake per year}$$`
--

### Q: Can the model tell us about the "error" associated with its parameters estimation or predictions?

--

### A: Nothing. We need an elaborate probability model and then do statistical analysis.


--

- a working model:

`$$N = a e^{b R+\epsilon},\quad \epsilon\sim N(0,\sigma^2)$$`
- fit the model by the sample `\(N_i, i=1,\dots, n\)`

---

## Problem formulations

- Random sample: `\(\boldsymbol{X}=(X_1,\dots, X_n)\)`

- `\(\boldsymbol{X}\sim P\)` (population)

### Simple random sample

- `\(X_i\)` are independent and identically distributed (iid)

- `\(X_i\stackrel{d}= X\sim P\)`, i.e., `\(X_i\stackrel{iid}\sim P\)`

### Model assumption

`$$P\in \mathcal P$$`

- `\(\mathcal P\)` is **a family of distributions**.

- parametric family: `\(\mathcal P=\{P_\theta,\theta\in\Theta\}\)`, i.e, `\(P=P_\theta\)` with unknown `\(\theta\)`

- nonparametric  or semi-parametric family

---
## Specification of statistical inference

### 1. Estimation

- unknown parameters: `\(\theta\)`

- prediction: `\(X_{n+1}\)`

- some information about the population, such as probability of the event of interest `\(P_\theta(A)\)`, density, CDF, expectation, variance, and so on.


### 2. Hypothesis tests

- Two-decision problem

- `\(H_0: P\in \mathcal P_0\ vs.\ H_1:P\in  \mathcal P_1\)`

- `\(H_0: \theta\in \Theta_0\ vs.\ H_1:\theta\in  \Theta_1\)`

---
## Example 1: iris (鸢尾花) data 

This famous (Fisher's or Anderson's) iris data set gives the measurements in centimeters of the variables sepal (花萼) length and width and petal (花瓣) length and width, respectively, for 50 flowers from each of 3 species of iris (鸢尾花). The species are Iris **setosa**, **versicolor**, and **virginica**.

![](figs/iris.png)

### Problems of interest

- Estimate the four variables for the three species

- Do Iris species differ in their variables?

---
## iris data

<div id="htmlwidget-3b22572e87732d0150a7" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-3b22572e87732d0150a7">{"x":{"filter":"none","fillContainer":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150"],[5.1,4.9,4.7,4.6,5,5.4,4.6,5,4.4,4.9,5.4,4.8,4.8,4.3,5.8,5.7,5.4,5.1,5.7,5.1,5.4,5.1,4.6,5.1,4.8,5,5,5.2,5.2,4.7,4.8,5.4,5.2,5.5,4.9,5,5.5,4.9,4.4,5.1,5,4.5,4.4,5,5.1,4.8,5.1,4.6,5.3,5,7,6.4,6.9,5.5,6.5,5.7,6.3,4.9,6.6,5.2,5,5.9,6,6.1,5.6,6.7,5.6,5.8,6.2,5.6,5.9,6.1,6.3,6.1,6.4,6.6,6.8,6.7,6,5.7,5.5,5.5,5.8,6,5.4,6,6.7,6.3,5.6,5.5,5.5,6.1,5.8,5,5.6,5.7,5.7,6.2,5.1,5.7,6.3,5.8,7.1,6.3,6.5,7.6,4.9,7.3,6.7,7.2,6.5,6.4,6.8,5.7,5.8,6.4,6.5,7.7,7.7,6,6.9,5.6,7.7,6.3,6.7,7.2,6.2,6.1,6.4,7.2,7.4,7.9,6.4,6.3,6.1,7.7,6.3,6.4,6,6.9,6.7,6.9,5.8,6.8,6.7,6.7,6.3,6.5,6.2,5.9],[3.5,3,3.2,3.1,3.6,3.9,3.4,3.4,2.9,3.1,3.7,3.4,3,3,4,4.4,3.9,3.5,3.8,3.8,3.4,3.7,3.6,3.3,3.4,3,3.4,3.5,3.4,3.2,3.1,3.4,4.1,4.2,3.1,3.2,3.5,3.6,3,3.4,3.5,2.3,3.2,3.5,3.8,3,3.8,3.2,3.7,3.3,3.2,3.2,3.1,2.3,2.8,2.8,3.3,2.4,2.9,2.7,2,3,2.2,2.9,2.9,3.1,3,2.7,2.2,2.5,3.2,2.8,2.5,2.8,2.9,3,2.8,3,2.9,2.6,2.4,2.4,2.7,2.7,3,3.4,3.1,2.3,3,2.5,2.6,3,2.6,2.3,2.7,3,2.9,2.9,2.5,2.8,3.3,2.7,3,2.9,3,3,2.5,2.9,2.5,3.6,3.2,2.7,3,2.5,2.8,3.2,3,3.8,2.6,2.2,3.2,2.8,2.8,2.7,3.3,3.2,2.8,3,2.8,3,2.8,3.8,2.8,2.8,2.6,3,3.4,3.1,3,3.1,3.1,3.1,2.7,3.2,3.3,3,2.5,3,3.4,3],[1.4,1.4,1.3,1.5,1.4,1.7,1.4,1.5,1.4,1.5,1.5,1.6,1.4,1.1,1.2,1.5,1.3,1.4,1.7,1.5,1.7,1.5,1,1.7,1.9,1.6,1.6,1.5,1.4,1.6,1.6,1.5,1.5,1.4,1.5,1.2,1.3,1.4,1.3,1.5,1.3,1.3,1.3,1.6,1.9,1.4,1.6,1.4,1.5,1.4,4.7,4.5,4.9,4,4.6,4.5,4.7,3.3,4.6,3.9,3.5,4.2,4,4.7,3.6,4.4,4.5,4.1,4.5,3.9,4.8,4,4.9,4.7,4.3,4.4,4.8,5,4.5,3.5,3.8,3.7,3.9,5.1,4.5,4.5,4.7,4.4,4.1,4,4.4,4.6,4,3.3,4.2,4.2,4.2,4.3,3,4.1,6,5.1,5.9,5.6,5.8,6.6,4.5,6.3,5.8,6.1,5.1,5.3,5.5,5,5.1,5.3,5.5,6.7,6.9,5,5.7,4.9,6.7,4.9,5.7,6,4.8,4.9,5.6,5.8,6.1,6.4,5.6,5.1,5.6,6.1,5.6,5.5,4.8,5.4,5.6,5.1,5.1,5.9,5.7,5.2,5,5.2,5.4,5.1],[0.2,0.2,0.2,0.2,0.2,0.4,0.3,0.2,0.2,0.1,0.2,0.2,0.1,0.1,0.2,0.4,0.4,0.3,0.3,0.3,0.2,0.4,0.2,0.5,0.2,0.2,0.4,0.2,0.2,0.2,0.2,0.4,0.1,0.2,0.2,0.2,0.2,0.1,0.2,0.2,0.3,0.3,0.2,0.6,0.4,0.3,0.2,0.2,0.2,0.2,1.4,1.5,1.5,1.3,1.5,1.3,1.6,1,1.3,1.4,1,1.5,1,1.4,1.3,1.4,1.5,1,1.5,1.1,1.8,1.3,1.5,1.2,1.3,1.4,1.4,1.7,1.5,1,1.1,1,1.2,1.6,1.5,1.6,1.5,1.3,1.3,1.3,1.2,1.4,1.2,1,1.3,1.2,1.3,1.3,1.1,1.3,2.5,1.9,2.1,1.8,2.2,2.1,1.7,1.8,1.8,2.5,2,1.9,2.1,2,2.4,2.3,1.8,2.2,2.3,1.5,2.3,2,2,1.8,2.1,1.8,1.8,1.8,2.1,1.6,1.9,2,2.2,1.5,1.4,2.3,2.4,1.8,1.8,2.1,2.4,2.3,1.9,2.3,2.5,2.3,1.9,2,2.3,1.8],["setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","setosa","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","versicolor","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica","virginica"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Sepal.Length<\/th>\n      <th>Sepal.Width<\/th>\n      <th>Petal.Length<\/th>\n      <th>Petal.Width<\/th>\n      <th>Species<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":8,"columnDefs":[{"className":"dt-right","targets":[1,2,3,4]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[8,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>


---

## Example 2: microarray (微阵列) data

An analysis of the microarray
data comes from an HIV study. The goal of the HIV study (van’t
Wout et al. 2003) is to discover differentially expressed genes between **HIV positive patients** and **HIV negative controls**.

&lt;img src="figs/gene.png" width="60%" style="display: block; margin: auto;" /&gt;


Reference: van’t Wout, A., Lehrman, G., Mikheeva, S., O’Keeffe, G., Katze, M.,
Bumgarner, R., Geiss, G., and Mullins, J. (2003), "Cellular Gene Expression
Upon Human Immunodeficiency Virus Type 1 Infection of CD4+-T-Cell
Lines", Journal of Virology, 77, 1392–1402.

---

## Example 3: censored (删失) data

Censoring is a condition in which the value of a measurement or observation is only partially known.

&lt;img src="figs/Censored_Data_Example.svg" width="50%" style="display: block; margin: auto;" /&gt;

Applications:

&lt;img src="figs/bulb.jpg" width="20%" /&gt;&lt;img src="figs/medicine.jpg" width="20%" /&gt;

![](figs/bulb.jpg) ![](figs/medicine.jpg)
---

## Frequentist vs. Bayesian

### Frequentist

- `\(\theta\)` is a **fixed** but unknown parameter

- inference depends only on the probability model and the sample  (let the data speak)

### Bayesian

- originated from **Thomas Bayes** (1702-1761)

- `\(\theta\)` is treated as a **random** parameter

- use prior info. for `\(\theta\)`

- inference depends not only on the sample and model, but also the prior

`$$\text{Bayes' rule:}\quad P(\theta| \text{data})= \frac{P(\theta)P(\text{data}|\theta)}{P(\text{data})}$$`


---
class: center, middle
# Readings

### TB1: 第一章 绪论
### TB2: Chapter 7 Survey Sampling

微信公众号《勤学派》：现代统计“四大天王”: Karl Pearson, Ronald Fisher, Egon Pearson, Jerzy Neyman.
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
